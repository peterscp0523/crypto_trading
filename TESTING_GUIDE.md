# 🧪 테스팅 가이드

업데이트된 트레이딩 봇을 안전하게 테스트하는 방법입니다.

## 📋 목차

1. [전략 검증 테스트](#1-전략-검증-테스트)
2. [백테스팅](#2-백테스팅)
3. [드라이런 모드](#3-드라이런-모드-시뮬레이션)
4. [실제 운영](#4-실제-운영)

---

## 1. 전략 검증 테스트

**목적:** API 연결, 지표 계산, 추세 분석이 정상 작동하는지 확인

### 실행 방법

```bash
python test_strategy.py
```

### 확인 사항

✅ API 연결 성공
✅ 계좌 조회 가능
✅ 1시간/4시간 추세 분석 정상
✅ RSI, 볼린저밴드, 거래량 계산 정상
✅ 매수/매도 신호 로직 동작

### 예상 출력

```
##############################################################
🧪 전략 테스트 시작
⏰ 2025-12-27 14:30:00
##############################################################

============================================================
🔌 API 연결 테스트
============================================================

✅ 계좌 조회 성공: 2개 화폐
   KRW: 1,000,000.00
   ETH: 0.25

✅ 시세 조회 성공
   ETH: 4,500,000원
   24h 변동: +2.35%

============================================================
📊 다중 시간대 추세 분석 테스트
============================================================

✅ 1시간봉: 200개
✅ 4시간봉: 200개

⏱️  1시간봉:
   추세: ↑ 상승
   RSI: 58.3
   MA20: 4,480,000원
   MA50: 4,420,000원
   현재가: 4,500,000원

⏱️  4시간봉:
   추세: ↑ 상승
   RSI: 62.1
   MA20: 4,450,000원
   MA50: 4,380,000원
   현재가: 4,500,000원

📈 추세 상태: 🚀 강한 상승
🎯 매수 허용: ✅ 가능
🎯 RSI 기준: < 40
```

---

## 2. 백테스팅

**목적:** 과거 데이터로 전략의 수익성 검증

### 실행 방법

```bash
python backtest.py
```

### 설정 변경

[backtest.py](backtest.py)의 마지막 부분에서 설정 가능:

```python
# 테스트 기간 변경 (일 단위)
backtester.run(days=7, initial_balance=1000000)
# days=30 → 30일 백테스트
# initial_balance=500000 → 초기 50만원
```

### 예상 결과

```
============================================================
백테스트 시작: KRW-ETH
기간: 최근 7일
초기 자금: 1,000,000원
============================================================

데이터 로딩 중...
✅ 672개 캔들 로드 완료

[2025-12-20 10:15:00] 🔵 매수: 4,200,000원 RSI:32.5 [조정]
[2025-12-20 15:30:00] 🟢 익절: 4,200,000 → 4,410,000 (+5.00%) 잔고: 1,050,000원
[2025-12-21 08:45:00] 🔵 매수: 4,150,000원 RSI:28.3 [약한반등]
[2025-12-21 14:20:00] 🔴 손절: 4,150,000 → 4,025,550 (-3.00%) 잔고: 1,018,500원
...

============================================================
백테스트 결과
============================================================
초기 자금: 1,000,000원
최종 잔고: 1,085,000원
총 손익: +85,000원 (+8.50%)

거래 횟수: 12회
승리: 8회
패배: 4회
승률: 66.7%

평균 수익: +62,500원
최대 수익: +105,000원
평균 손실: -31,250원
최대 손실: -35,000원
============================================================
```

### 백테스트 해석

- **승률 60% 이상**: 양호한 전략
- **평균 수익 > 평균 손실**: 리스크 대비 보상 좋음
- **총 손익 +5% 이상**: 수익성 있는 전략

---

## 3. 드라이런 모드 (시뮬레이션)

**목적:** 실시간 시장에서 실제 거래 없이 전략 테스트

### ⭐ 가장 추천하는 방법!

실제 거래 전에 **최소 1-3일** 동안 드라이런 모드로 실행해보세요.

### 실행 방법

```bash
python run_dry_run.py
```

### 특징

- ✅ 실제 API로 시장 데이터 수신
- ✅ 가상 잔고 100만원으로 시뮬레이션
- ✅ 실제 거래는 **절대 발생하지 않음**
- ✅ 텔레그램으로 모든 신호 수신
- ✅ 매수/매도 로직 실시간 검증

### 텔레그램 메시지 예시

```
🧪 [시뮬레이션] 💰 봇 시작
━━━━━━━━━━━━━━━━━

💵 원화: 1,000,000원
✅ 매수 신호 대기

⚙️ 전략:
  • 다중 시간대 분석 (1H + 4H)
  • 익절 5.0% / 손절 3.0%
  • 거래량 기준 1.2배
```

```
🧪 [시뮬레이션] 🔵 매수 완료
━━━━━━━━━━━━━━━━━

💰 금액: 1,000,000원
📊 가격: 4,500,000원
🪙 수량: 0.222222 ETH

📈 추세: 🚀 강한상승
  • 1H: ↑ RSI 38.5
  • 4H: ↑ RSI 55.2

📊 지표:
  • RSI: 35.2
  • 볼린저: 15.3%
  • 거래량: 1.25x

🎯 목표:
  • 익절: 4,725,000원 (+5%)
  • 손절: 4,365,000원 (-3%)
⏰ 14:25:30
```

### 명령어

드라이런 모드 실행 중 텔레그램에서 사용 가능:

- `/status` - 현재 가상 잔고 상태
- `/market` - 시장 현황 및 추세
- `/trend` - 상세 추세 분석
- `/position` - 현재 포지션
- `/report` - 거래 내역

### 중지

```
Ctrl+C
```

---

## 4. 실제 운영

**⚠️ 주의:** 드라이런 모드에서 충분히 검증한 후 실행하세요!

### 실행 전 체크리스트

- [ ] API 키 입력 완료 ([telegram_bot.py](telegram_bot.py) 하단)
- [ ] 텔레그램 봇 토큰/채팅ID 확인
- [ ] 최소 3일 드라이런 모드 테스트 완료
- [ ] 백테스팅 결과 승률 60% 이상
- [ ] 초기 투자금 결정 (권장: 10-50만원)

### 실행 방법

```bash
python telegram_bot.py
```

### 초기 메시지 확인

실제 모드에서는 "🧪 [시뮬레이션]" 표시가 **없습니다**:

```
💰 봇 시작
━━━━━━━━━━━━━━━━━

💵 원화: 500,000원
✅ 매수 신호 대기
```

### 실시간 모니터링

- 📱 텔레그램으로 모든 거래 알림 수신
- 💡 5분마다 자동 체크
- 🌙 매일 21시 일일 리포트

---

## 🎯 추천 테스팅 순서

### 초보자

1. ✅ **전략 검증** (`test_strategy.py`) - 5분
2. ✅ **백테스팅** (`backtest.py`) - 10분
3. ✅ **드라이런 3일** (`run_dry_run.py`) - 3일
4. ✅ 소액 실전 (10-20만원)

### 경험자

1. ✅ **백테스팅** 7-30일 - 10분
2. ✅ **드라이런 1일** - 1일
3. ✅ 실전 투자

---

## 📊 성능 평가 기준

### 좋은 신호

- ✅ 백테스팅 승률 65% 이상
- ✅ 평균 수익 > 평균 손실 * 2
- ✅ 드라이런에서 매수 신호 하루 1-3회
- ✅ 강한 하락 상황에서 매수 금지 작동

### 나쁜 신호

- ❌ 백테스팅 승률 50% 이하
- ❌ 드라이런에서 매수 신호 없음 (너무 보수적)
- ❌ 드라이런에서 매수 신호 과다 (하루 10회+)
- ❌ 손절이 너무 자주 발생

---

## 💡 팁

### 백테스팅 기간 조정

시장 상황에 따라 테스트 기간 변경:

```python
# 상승장이었던 기간
backtester.run(days=7, initial_balance=1000000)

# 하락장 포함 장기 테스트
backtester.run(days=30, initial_balance=1000000)
```

### 드라이런 모드 활용

- 낮 시간대 (09:00-18:00)에 실행하면 거래 신호 확인 용이
- 최소 1-2번의 매수/매도 사이클 관찰
- 추세 분석이 실제 시장과 맞는지 확인

### 실전 투자 전략

1. 소액으로 시작 (10-50만원)
2. 1-2주 실전 운영 후 평가
3. 승률 60% 이상이면 투자금 증액 고려
4. 연속 3회 손실 시 전략 재검토

---

## 🆘 문제 해결

### "데이터 부족" 오류

- 업비트 API 응답 확인
- 인터넷 연결 확인
- 잠시 후 재시도

### 텔레그램 메시지 안옴

- 봇 토큰/채팅ID 확인
- `/start` 명령어로 봇 활성화
- 봇을 차단하지 않았는지 확인

### 백테스팅 결과 부정확

- 수수료 미반영 (실제는 0.05% 수수료)
- 슬리피지 미반영 (시장가 주문 시 가격 차이)
- 참고용으로만 활용

---

## 📞 지원

문제가 있거나 질문이 있으면:

1. `test_strategy.py` 실행 결과 확인
2. 오류 메시지 캡처
3. 텔레그램 봇 로그 확인

---

**⚠️ 면책 조항**

- 이 봇은 교육/연구 목적입니다
- 투자 손실에 대한 책임은 사용자에게 있습니다
- 소액으로 테스트 후 사용하세요
- 과거 수익이 미래 수익을 보장하지 않습니다
